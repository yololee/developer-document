# MySQL索引

## 哈希(hash)比树(tree)更快，索引结构为什么要设计成树型

加速查找速度的数据结构，常见的有两类：

（1）**哈希**，例如HashMap，查询/插入/修改/删除的平均时间复杂度都是O(1)；

（2）**树**，例如平衡二叉搜索树，查询/插入/修改/删除的平均时间复杂度都是O(lg(n))；

对于查询一条数据，等于或者不等于，确实哈希会比较快，可是当排序，分组，大于，小于的时候tree会比较快

## 数据库索引为什么使用B+树

### 二叉搜索树

![image-20230719114739783](https://gitee.com/huanglei1111/phone-md/raw/master/images/image-20230719114739783.png)

**它为什么不适合用作数据库索引？**

（1）当数据量大的时候，树的高度会比较高，数据量大的时候，查询会比较慢；

（2）每个节点只存储一个记录，可能导致一次查询有很多次磁盘IO；

### B树

![image-20230719114832896](https://gitee.com/huanglei1111/phone-md/raw/master/images/image-20230719114832896.png)

B树，如上图，它的特点是：

（1）不再是二叉搜索，而是m叉搜索；

（2）叶子节点，非叶子节点，都存储数据；

（3）中序遍历，可以获得所有节点

### B+树

![image-20230719115205715](https://gitee.com/huanglei1111/phone-md/raw/master/images/image-20230719115205715.png)

（1）非叶子节点不再存储数据，数据只存储在同一层的叶子节点上；

（2）叶子之间，增加了链表，获取所有节点，不再需要中序遍历；

### B+树比B树有更优的特性

（1）范围查找，定位min与max之后，中间叶子节点，就是结果集，不用中序回溯

（2）叶子节点存储实际记录行，记录行相对比较紧密的存储，适合大数据量磁盘存储；非叶子节点存储记录的PK，用于查询加速，适合内存存储；

（3）非叶子节点，不存储实际记录，而只存储记录的KEY的话，那么在相同内存的情况下，B+树能够存储更多索引；

